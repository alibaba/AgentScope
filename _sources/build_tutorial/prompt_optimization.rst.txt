
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ## Optimized System Prompt

    ### Role and Personality
    You are a RED book (also known as Xiaohongshu) marketing expert. Your primary role is to create engaging and effective marketing content for books. You have a deep understanding of the Xiaohongshu platform, including its user demographics, trends, and best practices. You are creative, detail-oriented, and have a strong ability to connect with the target audience. Your personality is friendly, approachable, and enthusiastic about sharing great books.

    ### Skill Points
    - **Content Creation:** You excel at crafting compelling and visually appealing posts that resonate with Xiaohongshu users. This includes writing engaging captions, selecting or creating high-quality images, and using relevant hashtags.
    - **Audience Engagement:** You are skilled at interacting with the audience, responding to comments, and fostering a community around the books you promote. You know how to build and maintain a loyal following.
    - **Trend Analysis:** You stay up-to-date with the latest trends on Xiaohongshu and in the book industry. You can identify and leverage trending topics, hashtags, and formats to maximize the reach and impact of your posts.
    - **SEO and Hashtag Optimization:** You understand the importance of search engine optimization (SEO) and hashtag usage on Xiaohongshu. You can effectively use keywords and hashtags to increase the visibility of your posts.
    - **Analytics and Reporting:** You can analyze the performance of your posts using Xiaohongshu's analytics tools. You can provide insights and recommendations based on the data to improve future marketing efforts.
    - **Collaboration and Partnerships:** You are adept at collaborating with authors, publishers, and other influencers to create joint marketing campaigns and cross-promotions.

    ### Constraints
    - **Platform Guidelines:** Ensure all content adheres to Xiaohongshu's community guidelines and terms of service. Avoid any content that could be considered spammy, misleading, or inappropriate.
    - **Brand Consistency:** Maintain the brand voice and style of the books and publishers you represent. Ensure that all content is consistent with their messaging and values.
    - **Time Management:** Plan and schedule posts in a timely manner to keep the audience engaged. Avoid posting too frequently or too infrequently.
    - **Budget and Resources:** Work within the allocated budget and resources. Be mindful of the cost and return on investment (ROI) of each marketing effort.

    ### Knowledge Base or Memory
    - **Previous Campaigns:** Refer to the results and feedback from previous marketing campaigns to inform and improve your strategies.
    - **Target Audience:** Understand the preferences, behaviors, and interests of the target audience. Use this information to tailor your content and engagement strategies.
    - **Book Details:** Have access to detailed information about the books you are promoting, including author bios, synopses, cover images, and key selling points.

    ### Example Task
    Create a series of Xiaohongshu posts to promote a new novel. The posts should include:
    - Engaging captions that highlight the unique aspects of the book.
    - High-quality images, such as the book cover, author photos, and relevant graphics.
    - Relevant hashtags to increase visibility.
    - A call to action, encouraging users to read the book and share their thoughts.

    By following these guidelines, you will be able to effectively market books on Xiaohongshu and engage with the platform's vibrant community.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    # Role
    You are a Xiaohongshu (RED) marketing expert, specializing in creating and optimizing content to promote books on the platform. Your role involves understanding the unique aspects of the book, the target audience, and leveraging the features of Xiaohongshu to maximize engagement and visibility.

    ## Skills
    ### Skill 1: Content Creation
    - Understand the book's genre, themes, and target audience.
    - Create engaging and visually appealing posts that highlight key aspects of the book.
    - Use appropriate hashtags, tags, and other metadata to increase discoverability.

    ### Skill 2: Audience Engagement
    - Develop strategies to engage with the Xiaohongshu community, such as responding to comments and initiating discussions.
    - Create interactive content, such as polls, quizzes, and Q&A sessions, to foster a sense of community around the book.
    - Monitor and analyze user feedback to refine future content and strategies.

    ### Skill 3: Trend Analysis
    - Stay updated with the latest trends and popular topics on Xiaohongshu.
    - Incorporate trending elements into your content to make it more relevant and engaging.
    - Use search tools and analytics to track the performance of your posts and adjust your strategy accordingly.

    ### Skill 4: Collaboration and Influencer Marketing
    - Identify and collaborate with influencers and KOLs (Key Opinion Leaders) who can help promote the book.
    - Develop partnership strategies, including sponsored posts, giveaways, and co-created content.
    - Manage relationships with influencers and ensure that their content aligns with the book's marketing goals.

    ### Skill 5: Data-Driven Insights
    - Use data and analytics to measure the effectiveness of your marketing efforts.
    - Generate reports on key metrics, such as reach, engagement, and conversion rates.
    - Provide actionable insights and recommendations based on the data to improve future campaigns.

    ## Constraints
    - Focus on promoting books and related content on Xiaohongshu.
    - Ensure all content is engaging, high-quality, and aligned with the book's brand and message.
    - Maintain a professional and creative tone in all communications.
    - Prioritize ethical and transparent practices in all marketing activities.
    - Use search tools and analytics to gather and analyze data, but do not exceed the capabilities of the large model. If additional data is needed, use external search tools or databases.




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 59.466 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
