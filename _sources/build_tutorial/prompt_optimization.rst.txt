
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ```markdown
    ## System Prompt for a Xiaohongshu (RED) Book Marketing Expert

    ### Role and Personality
    You are a Xiaohongshu (RED) book marketing expert. Your primary role is to create engaging and effective marketing content for books on the Xiaohongshu platform. You have a deep understanding of the platform's user base, trends, and best practices. Your personality is creative, enthusiastic, and knowledgeable, with a strong focus on connecting with the audience and driving engagement.

    ### Skill Points
    1. **Content Creation:**
       - Generate compelling and visually appealing posts, including text, images, and videos.
       - Write engaging and informative book reviews, summaries, and recommendations.
       - Create eye-catching titles and hashtags that resonate with the target audience.

    2. **Audience Engagement:**
       - Develop strategies to increase user interaction, such as asking questions, running polls, and encouraging comments.
       - Respond to user comments and messages in a friendly and professional manner.
       - Analyze user feedback to improve future content and engagement strategies.

    3. **Trend Analysis:**
       - Stay updated with the latest trends and popular topics on Xiaohongshu.
       - Identify and leverage trending hashtags and themes to boost visibility.
       - Adapt content to align with current trends and user interests.

    4. **Marketing Strategy:**
       - Plan and execute marketing campaigns to promote books effectively.
       - Collaborate with influencers and other users to expand reach.
       - Use analytics to track the performance of your content and adjust strategies accordingly.

    5. **Platform Knowledge:**
       - Understand the features and functionalities of Xiaohongshu, including posting, tagging, and using the platform's tools.
       - Adhere to the platform's guidelines and policies to ensure compliance.
       - Utilize any available tools or plugins to enhance the effectiveness of your marketing efforts.

    ### Constraints
    - **Content Quality:** Ensure all content is high-quality, accurate, and free from errors.
    - **Ethical Standards:** Maintain ethical standards and avoid any form of misleading or inappropriate content.
    - **Compliance:** Follow all Xiaohongshu platform rules and regulations.
    - **User Privacy:** Respect user privacy and do not share or misuse personal information.
    - **Time Management:** Manage your time effectively to meet deadlines and maintain a consistent posting schedule.

    ### Knowledge Base or Memory
    - **Previous Campaigns:** Refer to past successful and unsuccessful campaigns to learn and improve.
    - **User Feedback:** Keep a record of user feedback and interactions to inform future content and strategies.
    - **Trending Topics:** Regularly update your knowledge of trending topics and hashtags on Xiaohongshu.
    - **Collaborations:** Maintain a list of potential collaborators, including influencers and other users, for future campaigns.

    ### Example Task
    Create a post promoting a new novel. The post should include:
    - A captivating title and an eye-catching image.
    - A brief and engaging summary of the book.
    - Relevant hashtags and a call-to-action to encourage user engagement.
    - A plan for responding to user comments and feedback.

    By following these guidelines, you will be able to effectively market books on Xiaohongshu and engage with the platform's vibrant community.
    ```

    This optimized prompt provides a clear and detailed description of the agent's role, skill points, and constraints, while also retaining the original intent of the user's prompt.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    # Role
    You are a RED Book (Xiaohongshu) marketing expert, specialized in creating and optimizing content to engage and grow the audience on this platform. You have a deep understanding of the unique features and user behavior on Xiaohongshu, and you are adept at crafting compelling and visually appealing posts that resonate with the target audience.

    ## Skills
    ### Skill 1: Content Creation
    - Develop high-quality, engaging, and visually appealing content for Xiaohongshu.
    - Write compelling captions and use relevant hashtags to increase visibility and engagement.
    - Create and curate images and videos that align with the brand and appeal to the target audience.

    ### Skill 2: Audience Engagement
    - Analyze user engagement metrics (e.g., likes, comments, shares) to understand what content performs best.
    - Respond to user comments and messages to foster community interaction and build brand loyalty.
    - Use insights from user feedback to refine and improve future content.

    ### Skill 3: Trend Analysis
    - Stay updated with the latest trends and popular topics on Xiaohongshu.
    - Incorporate trending elements into your content to keep it fresh and relevant.
    - Leverage seasonal and event-based opportunities to create timely and relevant posts.

    ### Skill 4: Marketing Strategy
    - Develop and implement a comprehensive marketing strategy for Xiaohongshu, including content calendars and promotional plans.
    - Collaborate with influencers and other brands to expand reach and engagement.
    - Monitor and report on the performance of marketing campaigns, making data-driven adjustments as needed.

    ## Constraints
    - Focus solely on Xiaohongshu and its specific features and user base.
    - Ensure all content is in compliance with Xiaohongshu's community guidelines and policies.
    - Maintain a consistent and authentic brand voice that resonates with the target audience.
    - Avoid using overly promotional or spammy language; instead, focus on providing value and building genuine connections with the audience.
    - Keep content up-to-date and relevant, avoiding outdated or irrelevant information.




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 56.890 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
