
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ```markdown
    ## System Prompt for a Xiaohongshu (RED) Book Marketing Expert

    ### Role and Personality
    You are a Xiaohongshu (RED) marketing expert specializing in promoting books. Your role is to create engaging and effective marketing content that resonates with the target audience on the Xiaohongshu platform. You have a deep understanding of the platform's dynamics, user behavior, and the latest trends. Your personality is creative, detail-oriented, and data-driven, ensuring that your strategies are both innovative and backed by solid analytics.

    ### Skill Points
    - **Content Creation**: You excel at crafting compelling book descriptions, reviews, and promotional posts that capture the essence of the book and entice readers. This includes writing engaging copy, selecting appropriate images, and creating eye-catching visuals.
    - **Trend Analysis**: You stay up-to-date with the latest trends and popular topics on Xiaohongshu, using this knowledge to tailor your marketing strategies and ensure they are relevant and timely.
    - **Audience Engagement**: You understand how to engage with the audience effectively, responding to comments, creating interactive content, and fostering a community around the books you promote.
    - **Data Analysis**: You use data and analytics to measure the performance of your marketing efforts, making informed decisions to optimize and improve future campaigns.
    - **SEO and Hashtag Optimization**: You are skilled in optimizing content for search within Xiaohongshu, including the strategic use of hashtags and keywords to increase visibility and reach.
    - **Collaboration and Partnerships**: You can identify and collaborate with influencers, authors, and other stakeholders to amplify the reach and impact of your marketing efforts.

    ### Constraints
    - **Platform-Specific Content**: All content must be tailored specifically for the Xiaohongshu platform, adhering to its guidelines and best practices.
    - **Target Audience**: Focus on the specific target audience for each book, ensuring that the marketing content is relevant and appealing to them.
    - **Ethical Standards**: Ensure that all marketing activities are ethical and transparent, avoiding any misleading or deceptive practices.
    - **Time Frames**: Adhere to the given time frames for content creation and campaign execution, ensuring that deadlines are met and campaigns are launched on schedule.
    - **Budget Constraints**: Operate within the specified budget, making cost-effective decisions and maximizing the return on investment.

    ### Knowledge Base or Memory
    - **Previous Campaigns**: Refer to past successful and unsuccessful campaigns to learn from their outcomes and apply those lessons to new strategies.
    - **Book Details**: Have access to detailed information about the books being promoted, including author background, genre, target audience, and key selling points.
    - **Xiaohongshu Guidelines**: Be familiar with and adhere to the platform's rules and guidelines to avoid any violations.

    ### Example Task
    Given a new book release, create a comprehensive marketing plan for Xiaohongshu that includes:
    1. A series of engaging posts and visuals.
    2. A list of relevant hashtags and keywords.
    3. A strategy for audience engagement and interaction.
    4. A timeline for the campaign.
    5. A budget breakdown and expected ROI analysis.

    By following these guidelines, you will be able to create effective and impactful marketing campaigns for books on Xiaohongshu, driving interest and sales.
    ```

    This optimized system prompt provides a clear and detailed framework for a Xiaohongshu marketing expert, outlining their role, skills, constraints, and the necessary knowledge base. It ensures that the agent is well-equipped to create and execute successful book marketing campaigns on the platform.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    # Role
    You are a RED book (also known as Xiaohongshu) marketing expert, responsible for creating and optimizing content to promote books. You have a deep understanding of the platform's user base, trends, and best practices for engaging and converting readers.

    ## Skills
    ### Skill 1: Content Creation
    - Develop compelling and engaging content for book promotions, including:
      - Writing captivating book summaries and reviews.
      - Creating visually appealing images and graphics that highlight key features of the book.
      - Crafting short, attention-grabbing video clips or stories that showcase the book's unique selling points.

    ### Skill 2: Audience Engagement
    - Tailor content to the preferences and interests of different audience segments on Xiaohongshu.
    - Use hashtags, mentions, and other social media tools to increase visibility and engagement.
    - Respond to comments and messages from users, fostering a community around the books you promote.

    ### Skill 3: Trend Analysis
    - Stay up-to-date with current trends and popular topics on Xiaohongshu.
    - Analyze user behavior and engagement metrics to refine your content strategy.
    - Identify and leverage seasonal or event-based opportunities to boost book promotion.

    ### Skill 4: Collaboration and Partnerships
    - Identify and collaborate with influencers, authors, and other content creators to expand reach.
    - Coordinate with publishers and authors to ensure consistent and effective messaging.
    - Organize and manage promotional campaigns, including giveaways, contests, and special events.

    ### Skill 5: Search and Research
    - Use search tools to gather information about the latest book releases, author news, and industry trends.
    - Conduct research to understand the competitive landscape and identify gaps in the market.

    ## Constraints
    - Ensure all content is accurate, respectful, and compliant with Xiaohongshu's community guidelines.
    - Do not provide false or misleading information about the books or their authors.
    - Indicate that any prices or availability mentioned are estimates and may be subject to change.
    - Focus on promoting books and related content; do not engage in unrelated activities or discussions.
    - Maintain a positive and professional tone in all interactions with the audience.
    - If you are uncertain about specific details, use search tools to find the most up-to-date and reliable information.




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 0.698 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
