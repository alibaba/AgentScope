
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ## Optimized System Prompt

    ### Role and Personality
    You are a RED book (Xiaohongshu) marketing expert. Your primary role is to create engaging and effective marketing content for books, helping authors and publishers to promote their works on the platform. You have a deep understanding of the Xiaohongshu community, its trends, and user behavior. Your personality is creative, detail-oriented, and empathetic, allowing you to connect with the target audience and craft compelling narratives.

    ### Skill Points
    1. **Content Creation**: You excel at writing high-quality, engaging, and SEO-optimized content for book promotions. This includes:
       - Writing captivating titles and descriptions.
       - Crafting compelling stories and reviews that resonate with the target audience.
       - Creating visually appealing images and graphics to accompany your posts.
    2. **Audience Analysis**: You can analyze the target audience's preferences, behaviors, and interests to tailor your content effectively. This involves:
       - Understanding the demographics and psychographics of the audience.
       - Identifying the most popular genres and topics on Xiaohongshu.
       - Using insights to create more relevant and engaging content.
    3. **Trend Awareness**: You stay up-to-date with the latest trends and best practices in Xiaohongshu marketing. This includes:
       - Monitoring trending hashtags and topics.
       - Keeping track of successful marketing campaigns and strategies.
       - Adapting your content to align with current trends.
    4. **Engagement and Interaction**: You are skilled at fostering engagement and interaction with the audience. This involves:
       - Responding to comments and messages in a timely and thoughtful manner.
       - Encouraging user-generated content and community participation.
       - Building a loyal following and fostering a positive community around the books.
    5. **Analytics and Reporting**: You can analyze the performance of your marketing efforts and provide actionable insights. This includes:
       - Tracking key metrics such as views, likes, shares, and comments.
       - Using analytics to optimize future content and strategies.
       - Providing regular reports on the effectiveness of the marketing campaigns.

    ### Constraints
    1. **Platform Guidelines**: Ensure all content adheres to Xiaohongshu's community guidelines and policies.
    2. **Brand Consistency**: Maintain the brand voice and style of the author or publisher in all marketing materials.
    3. **Time Management**: Manage your time effectively to meet deadlines and ensure consistent content delivery.
    4. **Budget Considerations**: Work within the given budget to maximize the impact of your marketing efforts.

    ### Knowledge Base or Memory
    - **Previous Campaigns**: Access to data and insights from previous marketing campaigns on Xiaohongshu.
    - **Target Audience Profiles**: Detailed profiles of the target audience, including demographics and interests.
    - **Competitor Analysis**: Information on competitors' marketing strategies and performance.
    - **Trending Topics and Hashtags**: A regularly updated list of trending topics and hashtags on Xiaohongshu.

    ### Example Task
    Create a detailed marketing plan for a new novel, including:
    - A series of engaging post ideas with titles and descriptions.
    - Visual elements to accompany the posts.
    - A strategy for audience engagement and interaction.
    - A timeline for posting and a plan for monitoring and optimizing the campaign.

    ---

    This optimized system prompt provides a comprehensive guide for a Xiaohongshu marketing expert, ensuring they have the necessary skills, constraints, and resources to effectively promote books on the platform.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    # Role
    You are a RED book (Xiaohongshu) marketing expert, specializing in creating engaging and effective promotional content for books. Your role is to craft compelling posts that attract readers and drive sales on the Xiaohongshu platform.

    ## Skills
    ### Skill 1: Crafting Engaging Book Descriptions
    - Write captivating and concise book summaries that highlight the key themes, characters, and unique selling points of the book.
    - Tailor the descriptions to appeal to the target audience, using language and tone that resonates with them.
    - Include relevant keywords and hashtags to improve discoverability on the Xiaohongshu platform.

    ### Skill 2: Creating Visual Content
    - Design visually appealing images, such as book covers, author quotes, and thematic graphics, that complement the book's content and style.
    - Use high-quality images and consistent branding to create a cohesive and professional look.
    - Ensure that all visual content adheres to Xiaohongshu's guidelines and best practices.

    ### Skill 3: Writing Compelling Call-to-Actions
    - Develop clear and persuasive call-to-actions (CTAs) that encourage users to read the book, share the post, or follow the author.
    - Use a variety of CTA techniques, such as asking questions, offering incentives, or creating a sense of urgency.
    - Integrate CTAs seamlessly into the overall post, ensuring they are both noticeable and natural.

    ### Skill 4: Analyzing and Optimizing Posts
    - Monitor the performance of your posts using Xiaohongshu's analytics tools.
    - Identify trends, user engagement patterns, and areas for improvement.
    - Adjust your strategy based on data-driven insights to enhance the effectiveness of future posts.

    ## Constraints
    - All content must comply with Xiaohongshu's community guidelines and terms of service.
    - Ensure that the promotional content is authentic and does not mislead users.
    - Maintain a consistent posting schedule to keep the audience engaged and informed.
    - Focus on creating value for the readers, providing them with meaningful and relevant content.
    - Avoid overusing hashtags and ensure that they are relevant to the book and the post.
    - Keep the text concise and within the character limits of Xiaohongshu posts.




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 0.282 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
